---
tags:
- Django
- Free Software
- FreeBSD
- 'GNU/Linux'
- Gentoo
- HOWTO
- администрирование
title: Новый дом
---

Тихо и незаметно переехал со старого детского адреса на новый джусорг.
Со старого сайта поставил перенаправление 301.

Когда-то я использовался FreeBSD, потому что это было решением по
умолчанию у провайдера. Где-то полгода назад я решил всё же перестать
мучать трупик и перешёл на Debian. Теперь на VDS-ку решил поставить
Gentoo. С Debian как-то неуютно. Такое впечатление, что все эти пакеты
как-то недобро на тебя косятся. Плюс очень хочется на сервере то же, что
и дома. Привык к устройству, сообществу и культуре. Плюс некоторые
пакеты для Джанги, которые дома установлены из [собственного оверлея][],
легко ставятся и на сервере без ручных операций. Да и Django хоть из
SVN, но по-прежнему требует вот уже единственного до сих пор не
попавшего в upstream [исправления][], которое накладывается во время
установки через Portage.

Быть может, однажды я наконец-то завяжу с Django и перейду на что-то
более расово верное, может веб-средства [Racket][] или же очень
интересный мне [Restas][]. Но пока что мне просто лень переделывать все
шаблоны.

Всякие Django и прочие hgweb поднялись сразу со старой конфигурацией
через FastCGI почти без изменений. Некоторое время заняла настройка
Exim, чем я раньше не занимался. Я наконец-то понял, как работает моя
почта. С веб-панельками было ничерта не понятно. Пока не понял, как же
заставить работать SMTP через TLS. То ли в сервере что-то недоуказал, то
ли это Гнус тупит. Также перенёс конфиги Dovecot и [Prosody][] (простой
Jabber-сервер на Lua, настраивается за несколько минут).

Надо сделать, наконец, поддержку OpenID здесь и успокоиться на этом ещё
на несколько лет.

## distcc

Конечно, бесят феерические тормоза при установке программ, не
сопоставимые с теми, что были на старом сервере. С другой стороны,
больше времени отнимают операции подготовки `emerge(1)` и инсталляции
пакета в файловую систему, а сборку я быстро поднял через `distcc(1)`,
компилируя пакеты на быстром домашнем компьютере. На сервере в
`/etc/distcc/hosts` указал:

     mybox.bounceme.net:7222,lzo,cpp

Доменное имя моему компьютеру делается через [no-ip][] и регулярно
обновляется [роутером][]. Дома в `/etc/conf.d/distccd` прописал демону
опцию `--allow` с IP-адресом VDS-ки, чтобы разрешить компилить только
пакеты с неё.

Оставалось только добавить на сервере в `FEATURES` файла
`/etc/make.conf` пунктик `distcc`. Установка на сервере запускается
через

    pump emerge some-package

На VDS-ке внезапно архитектура `x86_64`, а дома просто `x86`, то есть
дома потребовалось установить набор для кросс-компиляции с помощью
команды `crossdev -t x86_64`. В руководствах Gentoo рассказано о
каких-то шаманствах для того, чтобы кросскомпиляция работала в distcc,
но у меня всё завелось и так.

  [собственного оверлея]: http://dzhus.org:80/hg/gentoo-overlay
  [исправления]: http://code.djangoproject.com/ticket/7005
  [Racket]: http://www.racket-lang.org/
  [Restas]: http://restas.lisper.ru/
  [Prosody]: http://www.prosody.im/
  [no-ip]: http://www.no-ip.com/
  [роутером]: http://dzhus.org:80/blog/entry/new-router-nbg460n
